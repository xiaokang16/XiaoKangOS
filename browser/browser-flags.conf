#!/bin/bash

# XiaoKangOS Chromium Configuration
# This file contains all Chromium flags for kiosk mode

# Basic kiosk settings
CHROMIUM_FLAGS="--kiosk --no-first-run --no-default-browser-check --disable-infobars"

# Disable unnecessary features
CHROMIUM_FLAGS="${CHROMIUM_FLAGS} --disable-session-storage"
CHROMIUM_FLAGS="${CHROMIUM_FLAGS} --disable-translate"
CHROMIUM_FLAGS="${CHROMIUM_FLAGS} --disable-extensions"
CHROMIUM_FLAGS="${CHROMIUM_FLAGS} --disable-popup-blocking"
CHROMIUM_FLAGS="${CHROMIUM_FLAGS} --disable-background-networking"
CHROMIUM_FLAGS="${CHROMIUM_FLAGS} --disable-sync"
CHROMIUM_FLAGS="${CHROMIUM_FLAGS} --disable-dev-tools"
CHROMIUM_FLAGS="${CHROMIUM_FLAGS} --disable-logging"
CHROMIUM_FLAGS="${CHROMIUM_FLAGS} --disable-breakpad"
CHROMIUM_FLAGS="${CHROMIUM_FLAGS} --disable-crash-reporter"
CHROMIUM_FLAGS="${CHROMIUM_FLAGS} --metrics-recording-only"
CHROMIUM_FLAGS="${CHROMIUM_FLAGS} --mute-audio"
CHROMIUM_FLAGS="${CHROMIUM_FLAGS} --no-experiments"
CHROMIUM_FLAGS="${CHROMIUM_FLAGS} --ignore-autoplay-restrictions"
CHROMIUM_FLAGS="${CHROMIUM_FLAGS} --autoplay-policy=no-user-gesture-required"

# Performance flags
CHROMIUM_FLAGS="${CHROMIUM_FLAGS} --disable-gpu-driver-bug-workarounds"
CHROMIUM_FLAGS="${CHROMIUM_FLAGS} --enable-zero-copy"
CHROMIUM_FLAGS="${CHROMIUM_FLAGS} --ignore-gpu-blocklist"
CHROMIUM_FLAGS="${CHROMIUM_FLAGS} --enable-gpu-rasterization"
CHROMIUM_FLAGS="${CHROMIUM_FLAGS} --enable-features=NetworkService,NetworkServiceInProcess"
CHROMIUM_FLAGS="${CHROMIUM_FLAGS} --disable-ipc-flooding-protection"
CHROMIUM_FLAGS="${CHROMIUM_FLAGS} --disable-renderer-backgrounding"

# 3D and graphics acceleration
CHROMIUM_FLAGS="${CHROMIUM_FLAGS} --enable-webgl"
CHROMIUM_FLAGS="${CHROMIUM_FLAGS} --enable-accelerated-2d-canvas"
CHROMIUM_FLAGS="${CHROMIUM_FLAGS} --enable-accelerated-video-decode"
CHROMIUM_FLAGS="${CHROMIUM_FLAGS} --enable-hardware-overlays=single-fullscreen,single-on-top,underlay"
CHROMIUM_FLAGS="${CHROMIUM_FLAGS} --use-gl=egl"
CHROMIUM_FLAGS="${CHROMIUM_FLAGS} --enable-features=VaapiVideoDecoder"
CHROMIUM_FLAGS="${CHROMIUM_FLAGS} --use-cmd-decoder=validating"
CHROMIUM_FLAGS="${CHROMIUM_FLAGS} --enable-raw-draw"
CHROMIUM_FLAGS="${CHROMIUM_FLAGS} --force-color-profile=srgb"

# Window settings
CHROMIUM_FLAGS="${CHROMIUM_FLAGS} --start-fullscreen"
CHROMIUM_FLAGS="${CHROMIUM_FLAGS} --start-maximized"
CHROMIUM_FLAGS="${CHROMIUM_FLAGS} --window-size=1920,1080"

# Security flags
CHROMIUM_FLAGS="${CHROMIUM_FLAGS} --disable-web-security"
CHROMIUM_FLAGS="${CHROMIUM_FLAGS} --allow-file-access-from-files"
CHROMIUM_FLAGS="${CHROMIUM_FLAGS} --allow-universal-access-from-files"

# Remote debugging (for development)
# CHROMIUM_FLAGS="${CHROMIUM_FLAGS} --remote-debugging-port=9222"

# Native messaging host
CHROMIUM_FLAGS="${CHROMIUM_FLAGS} --native-client"

export CHROMIUM_FLAGS
